services:
    _defaults:
        autowire: true
        autoconfigure: true

    # Authorization
    EonX\EasySecurity\Interfaces\Authorization\AuthorizationMatrixFactoryInterface:
        class: EonX\EasySecurity\Authorization\AuthorizationMatrixFactory
        arguments:
            $rolesProviders: !tagged_iterator easy_security.roles_provider
            $permissionsProviders: !tagged_iterator easy_security.permissions_provider

    EonX\EasySecurity\Interfaces\Authorization\AuthorizationMatrixInterface:
        factory: ['@EonX\EasySecurity\Interfaces\Authorization\AuthorizationMatrixFactoryInterface', 'create']

    EonX\EasySecurity\Bridge\Symfony\Security\ContextAuthenticator: null

    EonX\EasySecurity\Bridge\Symfony\Interfaces\AuthenticationFailureResponseFactoryInterface:
        class: EonX\EasySecurity\Bridge\Symfony\Factories\AuthenticationFailureResponseFactory

    EonX\EasySecurity\Interfaces\SecurityContextFactoryInterface:
        class: EonX\EasySecurity\SecurityContextFactory

    EonX\EasySecurity\Interfaces\SecurityContextResolverInterface:
        class: EonX\EasySecurity\SecurityContextResolver

    EonX\EasySecurity\Bridge\Symfony\Interfaces\DeferredSecurityContextResolverInterface:
        class: EonX\EasySecurity\Bridge\Symfony\Helpers\DeferredSecurityContextResolver

    EonX\EasySecurity\Bridge\Symfony\Interfaces\DeferredContextResolverInterface: '@EonX\EasySecurity\Bridge\Symfony\Interfaces\DeferredSecurityContextResolverInterface'

    # DataCollector
    EonX\EasySecurity\Bridge\Symfony\DataCollector\SecurityContextDataCollector:
        tags:
            -   name: data_collector
                template: '@EasySecurity/Collector/security_context_collector.html.twig'
                id: !php/const EonX\EasySecurity\Bridge\Symfony\DataCollector\SecurityContextDataCollector::NAME
